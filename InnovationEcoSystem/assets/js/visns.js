"use strict";function initialize(){function n(n,e){n.marker.getServiceObject().setIcon({url:e,scaledSize:m?new google.maps.Size(48,64):new google.maps.Size(34,46),size:m?new google.maps.Size(48,64):new google.maps.Size(34,46)})}function e(e){if(e.id!==k.id){if(k.id)n(M.find(function(n){return n.id===k.id}),defaultVisnVaFacilityMarkerIcon);k=e,n(e,selectedVisnVaFacilityMarkerIcon)}}function i(e){e.id!==k.id&&n(e,hoverVisnVaFacilityMarkerIcon)}function o(e){e.id!==k.id&&n(e,defaultVisnVaFacilityMarkerIcon)}function t(n){M=_.map(n,function(n,t){n.marker=v[t];var a=n.marker.getServiceObject();return m&&(a.label={color:"#FFFFFF",text:""+n.number,fontFamily:"Open Sans"}),google.maps.event.addListener(a,"click",e.bind(this,n)),google.maps.event.addListener(a,"mouseover",i.bind(this,n)),google.maps.event.addListener(a,"mouseout",o.bind(this,n)),n})}function a(){if(k.id){var e=M.find(function(n){return n.id===k.id});e.marker.infowindow.close(),n(e,defaultVisnVaFacilityMarkerIcon),k={}}}function l(){$(document).arrive("img[src='http://www.google.com/intl/en_us/mapfiles/close.gif']",function(e){$(e).on("click",function(){k.id&&(n(M.find(function(n){return n.id===k.id}),defaultVisnVaFacilityMarkerIcon),k={})})})}function r(){var n=arguments.length<=0||arguments[0]===undefined?null:arguments[0],e=arguments.length<=1||arguments[1]===undefined?null:arguments[1],i=n||[],o=[];e&&(i=$(e+":checked").map(function(n,e){return e.value}).toArray()),0===i.length||7===i.length?o=visnVaFacilityMapData:visnVaFacilityMapData.map(function(n){i.some(function(e){return e===n.type})&&o.push(n)}),Gmaps.filter(o)}function s(){$(f).map(function(n,e){$(e).on("change",function(){r(null,f)})})}function d(){$(f).map(function(n,e){"VA Medical Center (VAMC)"===$(e).val()?$(e).prop("checked",!0):$(e).prop("checked",!1)})}function c(){m||google.maps.event.addListenerOnce(g.getMap(),"bounds_changed",function(){$(".dm-visn-show-map").removeClass("display-none"),$(".dm-visn-map-loading-spinner").addClass("display-none")})}function u(){$(document).on("click",".facility-type-checkbox-label",function(){g.resetBounds()})}var p=window.location.href,m="visns"===(""===p.split("/").pop()?p.split("/").slice(-2)[0]:p.split("/").pop()),f="input.dm-visn-map-filter-checkbox",g=Gmaps.build("Google",{builders:{Marker:m?VisnInfoBoxBuilder:VisnVaFacilityInfoBoxBuilder},markers:{clusterer:null}}),v=null,k={},M=null;m?g.buildMap({provider:{zoom:4,center:{lat:38.928865,lng:-95.795342},zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1},internal:{id:"visns-index-map"},markers:{options:{rich_marker:!0}}},function(){v=g.addMarkers(visnMapData),t(visnMapData),g.bounds.extendWith(v)}):g.buildMap({provider:{zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1},internal:{id:"visns-show-map"},markers:{options:{rich_marker:!0}}},function(){r(["VA Medical Center (VAMC)"])}),Gmaps.filter=function(n){g.removeMarkers(v),v=g.addMarkers(n),t(n),g.bounds.extendWith(v),g.fitMapToBounds()},m&&google.maps.event.addListener(g.getMap(),"idle",function(){$("#visns-index-map").removeClass("display-none"),$(".dm-loading-spinner").addClass("display-none")}),google.maps.event.addListener(g.getMap(),"tilesloaded",function(){l()}),google.maps.event.addListener(g.getMap(),"click",function(){a()}),c(),d(),s(),u()}$(document).on("turbolinks:load",function(){google.maps.event.addDomListener(window,"load",initialize)});