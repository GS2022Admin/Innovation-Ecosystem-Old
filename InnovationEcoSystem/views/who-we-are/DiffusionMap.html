<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="en" class="ie6"> <![endif]--><!--[if IE 7 ]> <html lang="en" class="ie7"> <![endif]--><!--[if IE 8 ]> <html lang="en" class="ie8"> <![endif]--><!--[if IE 9 ]> <html lang="en" class="ie9"> <![endif]--><!--[if (gt IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->
<head>


    <title>VHA Innovation Ecosystem - VHA Innovation Ecosystem Team</title>
    <meta name="description"
          content="The National Center for Collaborative Healthcare Innovation
The National Center for Collaborative Healthcare Innovation (NCCHI) leads partnerships to solve the greatest health care challenges facing Veterans. Located in Silicon Valley, NCCHI collaborates broadly with industry partners, other government agencies, academia, and throughout VA to create far-reaching positive impact for our Veterans with cutting-edge technologies.">
    <meta name="keywords" content="">


    <!-- High Level meta data -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cache-control" content="no-cache, must-revalidate, post-check=0, pre-check=0" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <script src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?ver=true&amp;agency=VA"></script>


    <!-- Links -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.css">
    <link rel="stylesheet" href="/INNOVATIONECOSYSTEM/assets/uswds-2-0-3/css/uswds.css">
    <link rel="stylesheet" href="/INNOVATIONECOSYSTEM/assets/css/main.css">
    <link rel="stylesheet" href="/INNOVATIONECOSYSTEM/assets/fontawesome-free-5-11-1-web/css/all.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <style type="text/css">
        /* Always set the map height explicitly to define the size of the div
        * element that contains the map. */
        #map {
            height: 550px !important;
            width: 1024px !important;
        }

        /* Optional: Makes the sample page fill the window. */
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
    <!-- JS Scripts -->
    <script type="text/javascript" src="/INNOVATIONECOSYSTEM/assets/uswds-2-0-3/js/uswds.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.js"></script>

    <script src="https://code.jquery.com/jquery-3.3.1.js"
            integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous">
    </script>


</head>

<body class="letter-spacing sub-text">
    <script type="text/javascript">
        $(function () {
            $("#header").load("/INNOVATIONECOSYSTEM/partials/header.html");
            $("#footer").load("/INNOVATIONECOSYSTEM/partials/footer.html");
        });


    </script>
    <script type="text/javascript">

        function initMap() {
            const CenterMap = new google.maps.LatLng(38.814043973419075, -96.70600664627496);
            const map = new google.maps.Map(document.getElementById("map"), {
                center: CenterMap,
                zoom: 4,
                mapId: '91067f069f5d14ac'
            });
            var jsonString = '{"VISN_Locations":[{"Id":"1", "lat": 40.867622,"long": -73.906372, "name": "Title for VISN 1", "cnt": "content for VISN 1 goes here"},{"Id":"2", "lat": 40.494436,"long": -79.888479, "name": "Title for VISN 2", "cnt": "content for VISN 2 goes here"},{"Id":"4", "lat": 39.205863,"long": -76.672969, "name": "Title for VISN 4", "cnt": "content for VISN 4 goes here"},{"Id":"5", "lat": 35.963796,"long": -78.960694, "name": "Title for VISN 5", "cnt": "content for VISN 5 goes here"},{"Id":"6", "lat": 33.945946,"long": -84.128073, "name": "Title for VISN 6", "cnt": "content for VISN 6 goes here"},{"Id":"7", "lat": 27.89228,"long": -82.656235, "name": "Title for VISN 7", "cnt": "content for VISN 7 goes here"},{"Id":"8", "lat": 36.152716,"long": -86.796089, "name": "Title for VISN 8", "cnt": "content for VISN 8 goes here"},{"Id":"9", "lat": 39.275373,"long": -84.347703, "name": "Title for VISN 9", "cnt": "content for VISN 9 goes here"},{"Id":"10", "lat": 41.84691,"long": -87.90513, "name": "Title for VISN 10", "cnt": "content for VISN 10 goes here"},{"Id":"12", "lat": 39.099796,"long": -94.581732, "name": "Title for VISN 12", "cnt": "content for VISN 12 goes here"},{"Id":"15", "lat": 32.405493,"long": -90.125014, "name": "Title for VISN 15", "cnt": "content for VISN 15 goes here"},{"Id":"16", "lat": 32.762672,"long": -97.068927, "name": "Title for VISN 16", "cnt": "content for VISN 16 goes here"},{"Id":"17", "lat": 39.696223,"long": -104.93885, "name": "Title for VISN 17", "cnt": "content for VISN 17 goes here"},{"Id":"19", "lat": 45.63918,"long": -122.658137, "name": "Title for VISN 19", "cnt": "content for VISN 19 goes here"},{"Id":"20", "lat": 37.960893,"long": -122.070705, "name": "Title for VISN 20", "cnt": "content for VISN 20 goes here"},{"Id":"21", "lat": 33.766677,"long": -118.200375, "name": "Title for VISN 21", "cnt": "content for VISN 21 goes here"},{"Id":"22", "lat": 44.855145,"long": -93.13046, "name": "Title for VISN 22", "cnt": "content for VISN 22 goes here"}]}';
            var jsonObj = JSON.parse(jsonString);
            var infowindow = new google.maps.InfoWindow({});
            var i;
            const cntemplate = "<br /><br /><table border='1'><tr style='font-size:15px; color:#222222; text-align:left; background-color:#F1F1F1'><td><label >TITLE</label></td></tr><tr><td><p style='font-size:15px; color:#222222'>CONTENT</p></td></tr></table>";
            for (i = 0; i < jsonObj.VISN_Locations.length; i++) {
                marker = new google.maps.Marker({
                    position: { lat: jsonObj.VISN_Locations[i].lat, lng: jsonObj.VISN_Locations[i].long },
                    map,
                    icon: { url: "https://maps.gstatic.com/mapfiles/ridefinder-images/mm_20_red.png" },
                    title: "VISN : " + jsonObj.VISN_Locations[i].name,
                    zIndex: i,
                });
                ////////////////////////////////////////////
                google.maps.event.addListener(marker, 'click',
                    (function (marker, i)
                    {
                        return function () {
                        var cnt = cntemplate;
                        var cnt = cnt.replace("TITLE", jsonObj.VISN_Locations[i].name).replace("CONTENT", jsonObj.VISN_Locations[i].cnt);
                        infowindow.setContent(cnt);
                        infowindow.open(map, marker);
                        }
                    })
                (marker, i));
            }




            //const marker = new google.maps.Marker({
            //    position: Jacksonville,
            //    map,
            //    title: "title goes here",
            //    icon: {
            //        url: "/InnovationEcoSystem/assets/images/pin.png",
            //        scaledSize: new google.maps.Size(35, 57)
            //    },
            //    //   animation: google.maps.Animation.DROP

            //});
          //  const cnt = "<table border='1'><tr><td><label style='font-size:17px; color:blue; text-align:left; background-color:#c0c0c0'>Title</label></td></tr><tr><td><p style='font-size:15px; color:#222222'>content goes here</p></td></tr></table>";
            //////////////////////////////////////////////
           //const coordInfoWindow = new google.maps.InfoWindow();

            //  coordInfoWindow.setContent(createInfoWindowContent(Kansas, map.getZoom()));
            //coordInfoWindow.setContent("the content goes here 2");
            //coordInfoWindow.setPosition(Jacksonville);
            //    coordInfoWindow.open(map);
            //map.addListener("zoom_changed", () => {
            //    // coordInfoWindow.setContent(createInfoWindowContent(Kansas, map.getZoom()));
            //    coordInfoWindow.title = "Jacksonville title";
            //    coordInfoWindow.setContent(cnt);
            //    coordInfoWindow.open(map);
            //});


            //////////////////////////////////////////////////////////////////////////////
            //marker.addListener("click", () => {
            //    coordInfoWindow.open(map, marker);
            //});
            //////////////////////////////////////////////////////////////////////////////
        }

        function initMapOriginal() {
            const Jacksonville = new google.maps.LatLng(30.332878449706413, -81.6597395068407);
            const Kansas = new google.maps.LatLng(38.814043973419075, -96.70600664627496);
            const map = new google.maps.Map(document.getElementById("map"), {
                center: Kansas,
                zoom: 4,
                mapId: '91067f069f5d14ac'
            });

            const marker = new google.maps.Marker({
                position: Jacksonville,
                map,
                title: "title goes here",
                icon: {
                    url: "/InnovationEcoSystem/assets/images/pin.png",
                    scaledSize: new google.maps.Size(35, 57)
                },
                //   animation: google.maps.Animation.DROP

            });
            const cnt = "<table border='1'><tr><td><label style='font-size:17px; color:blue; text-align:left; background-color:#c0c0c0'>Title</label></td></tr><tr><td><p style='font-size:15px; color:#222222'>content goes here</p></td></tr></table>";
            //////////////////////////////////////////////
            const coordInfoWindow = new google.maps.InfoWindow();

            //  coordInfoWindow.setContent(createInfoWindowContent(Kansas, map.getZoom()));
            coordInfoWindow.setContent("the content goes here 2");
            coordInfoWindow.setPosition(Jacksonville);
            //    coordInfoWindow.open(map);
            map.addListener("zoom_changed", () => {
                // coordInfoWindow.setContent(createInfoWindowContent(Kansas, map.getZoom()));
                coordInfoWindow.title = "Jacksonville title";
                coordInfoWindow.setContent(cnt);
                coordInfoWindow.open(map);
            });


            //////////////////////////////////////////////////////////////////////////////
            marker.addListener("click", () => {
                coordInfoWindow.open(map, marker);
            });
            //////////////////////////////////////////////////////////////////////////////
        }

        const TILE_SIZE = 256;

        function createInfoWindowContent(latLng, zoom) {
            const scale = 1 << zoom;
            const worldCoordinate = project(latLng);
            const pixelCoordinate = new google.maps.Point(
                Math.floor(worldCoordinate.x * scale),
                Math.floor(worldCoordinate.y * scale)
            );
            const tileCoordinate = new google.maps.Point(
                Math.floor((worldCoordinate.x * scale) / TILE_SIZE),
                Math.floor((worldCoordinate.y * scale) / TILE_SIZE)
            );
            return [
                "Jacksonville, FL",
                "LatLng: " + latLng,
            ].join("<br>");
        }


        function project(latLng) {
            let siny = Math.sin((latLng.lat() * Math.PI) / 180);
            siny = Math.min(Math.max(siny, -0.9999), 0.9999);
            return new google.maps.Point(
                TILE_SIZE * (0.5 + latLng.lng() / 360),
                TILE_SIZE * (0.5 - Math.log((1 + siny) / (1 - siny)) / (4 * Math.PI))
            );
        }


        function Display_VISNLocations() {
            //var text = '{"name":" Clark Kent",\"birth":"1996-12-14", "city":"Manhattan"}';
            //var obj = JSON.parse(text);
            //obj.birth = new Date(obj.birth);
            //alert(obj.name + ", " + obj.birth);


            var jsonString = '{"VISN_Locations":[{"Id":"1", "lat": 40.867622,"long": -73.906372},{"Id":"2", "lat": 40.494436,"long": -79.888479},{"Id":"4", "lat": 39.205863,"long": -76.672969},{"Id":"5", "lat": 35.963796,"long": -78.960694},{"Id":"6", "lat": 33.945946,"long": -84.128073},{"Id":"7", "lat": 27.89228,"long": -82.656235},{"Id":"8", "lat": 36.152716,"long": -86.796089},{"Id":"9", "lat": 39.275373,"long": -84.347703},{"Id":"10", "lat": 41.84691,"long": -87.90513},{"Id":"12", "lat": 39.099796,"long": -94.581732},{"Id":"15", "lat": 32.405493,"long": -90.125014},{"Id":"16", "lat": 32.762672,"long": -97.068927},{"Id":"17", "lat": 39.696223,"long": -104.93885},{"Id":"19", "lat": 45.63918,"long": -122.658137},{"Id":"20", "lat": 37.960893,"long": -122.070705},{"Id":"21", "lat": 33.766677,"long": -118.200375},{"Id":"22", "lat": 44.855145,"long": -93.13046}]}';
            var jsonObj = JSON.parse(jsonString);
            //  alert("step 2");

            //  alert("LENGTH = " + jsonObj.VISN_Locations.length);
            for (var n = 0; n < jsonObj.VISN_Locations.length; n++) {
                //  alert(" lat: " + jsonObj.VISN_Locations[n].lat + " lng: " + jsonObj.VISN_Locations[n].long);
                if (n > 2) return;
            }

            for (var i = 0; i < jsonObj.VISN_Locations.length; i++) {
                alert(i);
                new google.maps.Marker({
                    position: { lat: jsonObj.VISN_Locations[i].lat, lng: jsonObj.VISN_Locations[i].long },
                    map,
                    icon: { url: "/InnovationEcoSystem/assets/images/pin.png" },
                    title: "VISN : " + jsonObj.VISN_Locations[i].Id,
                    zIndex: i,
                });
            }
        }
    </script>
    <div id="header"></div>
    <br />
    <main id="main-content" class="home diffusion_map-main ">
        <section class="grid-container margin-top-10" id="map-of-diffusion">
            <h1>Diffusion map</h1>
        </section>
        <div>
            <div id="map" style="margin:0 auto !important"></div>
            <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDAitjhfyakBD6ZyuOaoJTJAOse8A02YyM&region=us_metro&map_ids=91067f069f5d14ac&callback=initMap"
                    async></script>
            <br />
            <figcaption>
                The map above highlights the current placement of Innovation Specialists
                across the country.
            </figcaption>
            <hr>
        </div>
    </main>
    <br />
    <div style="width:100% !important; height: 900px !important; background-color:#c0c0c0"></div>
    <div id="footer"></div>
    <!-- <script type="text/javascript" src="/assets/js/slick.js"></script>   -->
</body>
</html>